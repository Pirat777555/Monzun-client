(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{276:function(t,e,n){var content=n(279);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(52).default)("61d87ffc",content,!0,{sourceMap:!1})},277:function(t,e,n){"use strict";n.r(e);n(20),n(16),n(53),n(63),n(202),n(56);var o=n(17),r=n(0),c={data:function(){var t;return t={isActive:!1,file:[],url:null},Object(r.a)(t,"file",""),Object(r.a)(t,"editUser",{email:"",name:"",phone:"",avatarId:null}),Object(r.a)(t,"logo",{}),t},computed:{user:function(){return this.$store.state.user}},created:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.editUser.name=t.user.name,t.user.logo&&(t.url=t.user.logo.url);case 2:case"end":return e.stop()}}),e)})))()},methods:{visible:function(t){this.isActive=!this.isActive},onFileChange:function(t){var e=this,n=t.target.files[0];this.url=URL.createObjectURL(n),t.target.files[0].size>5e6&&(alert("File is too big!"),this.$refs.file.value=null),this.file=this.$refs.file.files[0];var o=new FormData;o.append("files",this.file),this.$axios.$post("https://monzun.herokuapp.com/api/attachment/upload-image",o,{headers:{Authorization:"Bearer "+this.$cookies.get("tokenUser")}}).then((function(t){e.$bvToast.toast("Изображение добавлено!",{title:"Добавление изображения",variant:"success"}),e.logo=t,e.editUser.avatarId=e.logo.id})).catch((function(t){e.$bvToast.toast("ошибка",{title:"Не удалось отправить изображение",variant:"danger",solid:!0})}))},deleteImage:function(){var t=this;this.$axios.$delete("https://monzun.herokuapp.com/api/attachment/delete/".concat(this.logo.uuid),{headers:{Authorization:"Bearer "+this.$cookies.get("tokenUser")}}).then((function(e){t.$bvToast.toast("Изображение удалено!",{title:"удаление изображений",variant:"success"}),t.$refs.file.value=null})).catch((function(e){t.$bvToast.toast("ошибка",{title:"Не удалось удалить изображение",variant:"danger",solid:!0})}))},changeUser:function(){var t=this;this.editUser.name=this.user.name,this.editUser.phone=this.user.phone,this.editUser.email=this.user.email,this.editUser.name=this.user.name,this.editUser.password=this.user.password,console.log(this.editUser),this.$axios.$put("https://monzun.herokuapp.com/api/me",this.editUser,{headers:{Authorization:"Bearer "+this.$cookies.get("tokenUser")}}).then((function(e){t.$bvToast.toast("Пользователь изменен!",{title:"Изменение пользователя",variant:"success"})})).catch((function(e){t.$bvToast.toast("ошибка",{title:"Не удалось изменить пользователя",variant:"danger",solid:!0})}))}}},l=(n(278),n(41)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row admin-panel"},[n("div",{staticClass:"col-12 admin d-flex"},[n("div",{staticClass:"avatar"},[t.user.logo?n("img",{attrs:{src:t.user.logo.url,alt:""}}):t._e(),t._v(" "),t.user.logo?t._e():n("img",{attrs:{src:"/images/noname.jpg",alt:""}})]),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(t.editUser.name))]),t._v(" "),n("div",{staticClass:"open-toggle",on:{click:t.visible}},[n("img",{attrs:{src:"/images/dropdown-toggle.png",alt:""}})])]),t._v(" "),n("div",{staticClass:"col-12 admin d-flex"},[n("div",{staticClass:"panel",class:{"panel-active":t.isActive}},[n("ul",[n("li",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-edit",modifiers:{"modal-edit":!0}}],staticClass:"btn-edit"},[t._v("Редактировать")])],1),t._v(" "),n("li",[n("nuxt-link",{attrs:{to:{name:"login"}},nativeOn:{click:function(e){t.$cookies.set("tokenUser",""),t.$store.commit("setUser",null)}}},[t._v("Выход")])],1)])])]),t._v(" "),n("b-modal",{attrs:{centered:"","hide-header":"","ok-only":"","ok-title":"Изменить",id:"modal-edit"},on:{ok:t.changeUser}},[n("div",{staticClass:"edit"},[n("form",{attrs:{method:"post"}},[n("div",[t.url?t._e():n("img",{staticClass:"edit-avatar",attrs:{src:"images/noname.jpg",alt:""}}),t._v(" "),t.url?n("img",{staticClass:"edit-avatar",attrs:{src:t.url}}):t._e()]),t._v(" "),n("div",{staticClass:"edit-image d-flex"},[n("input",{ref:"file",attrs:{type:"file",accept:"image/x-png,image/gif,image/jpeg"},on:{change:t.onFileChange}}),t._v(" "),n("div",{staticClass:"dlt",on:{click:t.deleteImage}},[n("img",{attrs:{src:"/images/delete.png",alt:""}})])]),t._v(" "),n("div",{staticClass:"edit-text"},[t._v("Имя")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],staticClass:"edit-info",attrs:{type:"text"},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}}),t._v(" "),n("div",{staticClass:"edit-text"},[t._v("Электронная почта")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"edit-info",attrs:{type:"email"},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}}),t._v(" "),n("div",{staticClass:"edit-text"},[t._v("Пароль")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"edit-info",attrs:{type:"password"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}}),t._v(" "),n("div",{staticClass:"edit-text"},[t._v("Телефон")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.user.phone,expression:"user.phone"}],staticClass:"edit-info",attrs:{type:"tel"},domProps:{value:t.user.phone},on:{input:function(e){e.target.composing||t.$set(t.user,"phone",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"close",on:{click:function(e){return t.$bvModal.hide("modal-edit")}}},[n("img",{attrs:{src:"/images/close-modal.svg",alt:""}})])])])],1)}),[],!1,null,"26d5fd97",null);e.default=component.exports},278:function(t,e,n){"use strict";n(276)},279:function(t,e,n){(e=n(51)(!1)).push([t.i,".admin-panel[data-v-26d5fd97]{margin-bottom:50px}.name[data-v-26d5fd97]{font-size:18px;line-height:115%;font-family:Futura PT;color:#77797d;margin-right:5px}.admin[data-v-26d5fd97]{align-items:center;justify-content:flex-end}.admin .avatar[data-v-26d5fd97]{margin-right:10px}.avatar img[data-v-26d5fd97]{width:40px;height:40px;border-radius:50px}.open-toggle[data-v-26d5fd97]{cursor:pointer}.admin-panel:hover .panel[data-v-26d5fd97]{opacity:1}.panel[data-v-26d5fd97]{border:1px solid #e2e2e2;background:#f7f5f5;padding:7px 7px 7px 20px;opacity:0;width:160px}.panel-active[data-v-26d5fd97]{opacity:1}.panel li[data-v-26d5fd97]{list-style-type:none;border-bottom:1px solid #e2e2e2;margin-top:10px}.panel li a[data-v-26d5fd97]{color:#000;text-decoration:none}.panel ul[data-v-26d5fd97]{padding:0;margin:0;text-align:center}.btn-edit[data-v-26d5fd97]{padding:0;background:transparent;border:none;color:#000}.close[data-v-26d5fd97]{position:absolute;top:10px;right:10px}.edit[data-v-26d5fd97]{text-align:center}.edit-avatar[data-v-26d5fd97]{width:100px;height:100px;border-radius:50%;margin-bottom:20px}.edit-text[data-v-26d5fd97]{font-family:Roboto;font-size:18px;line-height:16px;-moz-text-align-last:left;text-align-last:left;color:#000;margin-left:80px;margin-bottom:10px;margin-top:10px}form input[data-v-26d5fd97]{width:80%;padding:10px}.edit-image[data-v-26d5fd97]{width:80%;margin-left:150px}.edit-image input[data-v-26d5fd97]{width:400px}",""]),t.exports=e},301:function(t,e,n){var content=n(325);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(52).default)("7a5bb1e9",content,!0,{sourceMap:!1})},324:function(t,e,n){"use strict";n(301)},325:function(t,e,n){(e=n(51)(!1)).push([t.i,".set[data-v-5caf7579]{margin-top:30px}.btn-back[data-v-5caf7579]{background:#c4c4c4;border:none;font-family:Roboto;font-style:normal;font-weight:400;font-size:16px;line-height:19px;color:#000;width:100px;height:35px;margin-bottom:30px}.info-set[data-v-5caf7579]{border:1px solid #000;padding:35px}.kanban-column[data-v-5caf7579]{min-height:300px}.btn-task[data-v-5caf7579]{background:transparent;border:none;padding:0;color:#000}.title[data-v-5caf7579]{align-items:center}.close[data-v-5caf7579]{position:absolute;top:10px;right:10px}.task[data-v-5caf7579]{font-family:Roboto;font-size:18px;line-height:35px;color:#000}.task-name[data-v-5caf7579]{margin-right:50px}.other[data-v-5caf7579]{text-align:center}.btns[data-v-5caf7579]{margin-left:10px}.btn-send[data-v-5caf7579]{font-family:Roboto;font-style:normal;margin-top:15px;width:144px}",""]),t.exports=e},344:function(t,e,n){"use strict";n.r(e);n(6),n(20),n(56);var o=n(17),r=n(300),c={sockets:{connect:function(){console.log("socket connected")},customEmit:function(data){console.log('this method was fired by the socket server. eg: io.emit("customEmit", data)')}},components:{draggable:n.n(r).a},middleware:"authenticated",data:function(){return{newTask:"",arrToDo:[],arrDoing:[],arrInCheck:[],arrDone:[],activeSet:{},tasks:[],activeTask:{status:{alias:""}},startups:[],startup:{},elemetnId:null}},computed:{user:function(){return this.$store.state.user}},created:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 3==t.user.role.roleId&&t.$router.push({name:"sets_tracker"}),e.next=3,t.$axios.$get("https://monzun.herokuapp.com/api/trackings/".concat(t.$route.params.id),{headers:{Authorization:"Bearer "+t.$cookies.get("tokenUser")}});case 3:return t.activeSet=e.sent,e.next=6,t.$axios.$get("https://monzun.herokuapp.com/api/startups",{headers:{Authorization:"Bearer "+t.$cookies.get("tokenUser")}});case 6:return t.startups=e.sent,t.startup=t.startups[0],e.next=10,t.$axios.$get("https://monzun.herokuapp.com/api/tasks/".concat(t.$route.params.id,"/").concat(t.startup.id),{headers:{Authorization:"Bearer "+t.$cookies.get("tokenUser")}});case 10:for(t.tasks=e.sent,console.log(t.tasks),i=0;i<t.tasks.length;i++)"to do"==t.tasks[i].status.name&&t.arrToDo.push(t.tasks[i]),"doing"==t.tasks[i].status.name&&t.arrDoing.push(t.tasks[i]),"in check"==t.tasks[i].status.name&&t.arrInCheck.push(t.tasks[i]),"done"==t.tasks[i].status.name&&t.arrDone.push(t.tasks[i]);case 13:case"end":return e.stop()}}),e)})))()},methods:{message:function(data){this.$socket.emit("newMessage",data)},getTask:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.$get("https://monzun.herokuapp.com/api/tasks/".concat(t),{headers:{Authorization:"Bearer "+e.$cookies.get("tokenUser")}});case 3:e.activeTask=n.sent,e.$refs.task.show(),console.log(e.activeTask),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),e.$bvToast.toast("Не удалось получить данные задачи.",{title:"задача не найдена.",variant:"danger",solid:!0});case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},add:function(t,e){var n=this;t.added&&(this.elemetnId=t.added.element.id,console.log(e),this.$axios.$put("https://monzun.herokuapp.com/api/tasks-statuses/".concat(this.elemetnId,"/").concat(e),{},{headers:{Authorization:"Bearer "+this.$cookies.get("tokenUser")}}).then((function(t){n.$bvToast.toast("задача изменена!",{title:"изменение",variant:"success"})})).catch((function(t){n.$bvToast.toast("ошибка",{title:"Не удалось изменить задачу",variant:"danger",solid:!0})})))},progres:function(t,e){var n=new Date(t),o=new Date(e),r=new Date,c=Math.ceil((o.getTime()-n.getTime())/864e5),l=Math.ceil((r.getTime()-n.getTime())/864e5),d=Math.ceil(l/c*100);return d>=100&&(d=100),d<0&&(d=0),d},weekDate:function(t){var e=new Date(t),n=new Date,o=Math.ceil(Math.ceil((n.getTime()-e.getTime())/864e5)/7);return o<0&&(o=0),o}}},l=(n(324),n(41)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"set"},[n("div",{staticClass:"container"},[n("Client"),t._v(" "),n("div",{staticClass:"row justify-content-end"},[n("div",{staticClass:"col-auto"},[n("button",{staticClass:"btn-back",on:{click:function(e){return e.preventDefault(),t.$router.go(-1)}}},[t._v("\n                    Назад\n                ")])])]),t._v(" "),n("div",{staticClass:"row info-set"},[n("div",{staticClass:"col-lg-3"},[t._v(t._s(t.activeSet.name))]),t._v(" "),n("div",{staticClass:"col-lg-3"},[t._v("\n                Дата конца набора\n                "+t._s(t.activeSet.endedAt)+"\n            ")]),t._v(" "),n("div",{staticClass:"col-lg-3"},[t._v("\n                Неделя "+t._s(t.weekDate(t.activeSet.startedAt))+"\n            ")]),t._v(" "),n("div",{staticClass:"col-lg-3"},[n("progress-bar",{attrs:{value:t.progres(t.activeSet.startedAt,t.activeSet.endedAt)}})],1)]),t._v(" "),n("div",{staticClass:"row mt-5"},[n("div",{staticClass:"col-3"},[n("div",{staticClass:"p-2 alert alert-secondary"},[n("h4",[t._v("Планируется")]),t._v(" "),n("draggable",{staticClass:"list-group kanban-column",attrs:{list:t.arrToDo,group:"tasks"},on:{change:function(e){return t.add(e,1)}}},t._l(t.arrToDo,(function(element){return n("div",{key:element.name,staticClass:"list-group-item"},[n("b-button",{staticClass:"btn-task",on:{click:function(e){return t.getTask(element.id)}}},[t._v("\n                                "+t._s(element.name))]),t._v("\n                            "+t._s(element.date)+"\n                        ")],1)})),0)],1)]),t._v(" "),n("div",{staticClass:"col-3"},[n("div",{staticClass:"p-2 alert alert-primary"},[n("h4",[t._v("В работе")]),t._v(" "),n("draggable",{staticClass:"list-group kanban-column",attrs:{list:t.arrDoing,group:"tasks"},on:{change:function(e){return t.add(e,2)}}},t._l(t.arrDoing,(function(element){return n("div",{key:element.name,staticClass:"list-group-item"},[n("b-button",{staticClass:"btn-task",on:{click:function(e){return t.getTask(element.id)}}},[t._v("\n                                "+t._s(element.name))]),t._v("\n                            "+t._s(element.date)+"\n                        ")],1)})),0)],1)]),t._v(" "),n("div",{staticClass:"col-3"},[n("div",{staticClass:"p-2 alert alert-warning"},[n("h4",[t._v("В проверке")]),t._v(" "),n("draggable",{staticClass:"list-group kanban-column",attrs:{list:t.arrInCheck,group:"tasks"},on:{change:function(e){return t.add(e,3)}}},t._l(t.arrInCheck,(function(element){return n("div",{key:element.name,staticClass:"list-group-item"},[n("b-button",{staticClass:"btn-task",on:{click:function(e){return t.getTask(element.id)}}},[t._v("\n                                "+t._s(element.name))]),t._v("\n                            "+t._s(element.date)+"\n                        ")],1)})),0)],1)]),t._v(" "),n("div",{staticClass:"col-3"},[n("div",{staticClass:"p-2 alert alert-success"},[n("h4",[t._v("Готово")]),t._v(" "),n("draggable",{staticClass:"list-group kanban-column",attrs:{list:t.arrDone,group:"tasks"},on:{change:function(e){return t.add(e,4)}}},t._l(t.arrDone,(function(element){return n("div",{key:element.name,staticClass:"list-group-item"},[n("b-button",{staticClass:"btn-task",on:{click:function(e){return t.getTask(element.id)}}},[t._v("\n                                "+t._s(element.name))]),t._v("\n                            "+t._s(element.date)+"\n                        ")],1)})),0)],1)])])],1),t._v(" "),n("b-modal",{ref:"task",attrs:{centered:"","hide-header":"","hide-footer":"",id:"modal-task"}},[n("div",{staticClass:"task"},[n("div",{staticClass:"title d-flex align-content-center"},[n("div",{staticClass:"task-name"},[n("h2",[t._v(t._s(t.activeTask.name))])]),t._v(" "),n("div",{staticClass:"status"},[t._v("\n                    Статус задачи: "+t._s(t.activeTask.status.alias)+"\n                ")])]),t._v(" "),n("div",{staticClass:"info d-flex align-content-center justify-content-between"},[n("div",{staticClass:"description"},[n("div",{staticClass:"description-title"},[t._v("Описание задачи")]),t._v(" "),n("div",{staticClass:"description-text"},[t._v("\n                        "+t._s(t.activeTask.description)+"\n                    ")])]),t._v(" "),n("div",{staticClass:"other"},[n("div",{staticClass:"date"},[t._v("\n                        Дата завершения: "+t._s(t.activeTask.deadlineAt)+"\n                    ")]),t._v(" "),n("div",{staticClass:"file"},[t._v("\n                        Прикрепленные Файлы\n                        "),t._l(t.activeTask.attachments,(function(e,o){return n("div",{key:o},[n("a",{attrs:{href:e.url}},[n("img",{attrs:{src:"/images/file.png",alt:""}}),t._v(" "),n("div",{staticClass:"name"},[t._v("\n                                    "+t._s(e.originalFilename)+"\n                                ")])])])}))],2)])]),t._v(" "),n("hr"),t._v(" "),n("div",{staticClass:"chat-message"},[t._v("здесь сообщения")]),t._v(" "),n("div",{staticClass:"chat d-flex"},[n("textarea",{attrs:{name:"message",id:"",cols:"80",rows:"5"}}),t._v(" "),n("div",{staticClass:"btns"},[n("input",{attrs:{type:"file"}}),t._v(" "),n("button",{staticClass:"btn-send",on:{click:t.message}},[t._v("\n                        Отправить\n                    ")])])]),t._v(" "),n("div",{staticClass:"close",on:{click:function(e){return t.$bvModal.hide("modal-task")}}},[n("img",{attrs:{src:"/images/close-modal.svg",alt:""}})])])])],1)}),[],!1,null,"5caf7579",null);e.default=component.exports;installComponents(component,{Client:n(277).default})}}]);